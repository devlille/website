---
import { getCollection } from "astro:content";
import Pack from "../components/pack.astro";

const sponsors = (await getCollection("sponsors")).map((c) => c.data);

console.log(`Total sponsors in component: ${sponsors.length}`);
if (sponsors.length > 0) {
    console.log("First sponsor:", JSON.stringify(sponsors[0], null, 2));
}

const gold =
    sponsors.filter((s) => s.sponsoring.some((type) => type === "Pack Gold")) ??
    [];
const silver =
    sponsors.filter((s) =>
        s.sponsoring.some((type) => type === "Pack Silver"),
    ) ?? [];
const bronze =
    sponsors.filter((s) =>
        s.sponsoring.some((type) => type === "Pack Bronze"),
    ) ?? [];
const graineDeDevPartners =
    sponsors.filter((s) =>
        s.sponsoring.some(
            (type) => type === "Partenaires DevLille Graine de Dev",
        ),
    ) ?? [];
const hebergementPartners =
    sponsors.filter((s) =>
        s.sponsoring.some((type) => type === "Partenaire Hébergement"),
    ) ?? [];
const communityPartners =
    sponsors.filter((s) =>
        s.sponsoring.some((type) => type === "Community Partners"),
    ) ?? [];

console.log(
    `Gold: ${gold.length}, Silver: ${silver.length}, GraineDeDev: ${graineDeDevPartners.length}, Hébergement: ${hebergementPartners.length}, Community: ${communityPartners.length}`,
);
---

{gold.length > 0 && <Pack title="Gold" partners={gold} />}
{silver.length > 0 && <Pack title="Silver" partners={silver} />}
{
    graineDeDevPartners.length > 0 && (
        <Pack
            title="Partenaires DevLille Graine de Dev"
            partners={graineDeDevPartners}
        />
    )
}
{
    hebergementPartners.length > 0 && (
        <Pack title="Partenaire Hébergement" partners={hebergementPartners} />
    )
}
{
    communityPartners.length > 0 && (
        <Pack title="Community Partners" partners={communityPartners} />
    )
}
