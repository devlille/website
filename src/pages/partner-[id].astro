---
import type { GetStaticPaths } from "astro";
import { getCollection, type CollectionEntry } from "astro:content";
import Layout from "../layouts/Layout.astro";

const videos: Record<string, string> = {
  aGaY4K4bmCui5YwHAX1P: "NnqC0mDkmDI",
  nQ5LMHHfUnFZE85YdIOT: "7FPZqvYmdrA",
  IskRAkrAh5kHqOUc8TuF: "18kdzQ0sOF0",
  h5fEfoQf4jqXrQWbwD7v: "N53Ik0PvKYI",
  yE6KTKUWbzi1AmJEeTCo: "XTkTvysN6gQ",
  f7J4vkm24BaPxHPy7VJE: "QdTMvu3mAYE"
};
interface Props {
  sponsor: CollectionEntry<"sponsors">;
}

export const getStaticPaths = (async () => {
  const sponsors = await getCollection("sponsors");

  return sponsors.map((sponsor) => ({
    params: {
      id: sponsor.data.id,
    },
    props: {
      sponsor: sponsor,
    },
  }));
}) satisfies GetStaticPaths;

const { sponsor } = Astro.props;

const og = {
  ogDescription: sponsor.data.description?.replaceAll('"', "")?.trim(),
  ogUrl: "https://devlille.fr/partner-" + sponsor.data.id,
  ogImage: `https://devlille.fr/img/${sponsor.data.logoName}.${sponsor.data.ext}`,
};

const video = videos[sponsor.data.id] as string | undefined
---

<Layout title={sponsor.data.name} currSection="partners" og={og}>
  <div class="page-body">
    <div class="h-group sponsor">
      <p>
        {sponsor.data.siteUrl ? (
          <a href={sponsor.data.siteUrl} target="_blank" rel="noopener noreferrer">
            <img
              loading="lazy"
              src={sponsor.data.logoUrl}
              alt={`Logo de ${sponsor.data.name}`}
            />
          </a>
        ) : (
          <img
            loading="lazy"
            src={sponsor.data.logoUrl}
            alt={`Logo de ${sponsor.data.name}`}
          />
        )}
      </p>
      <h2>{sponsor.data.name}</h2>
    </div>

    <div class="sponsor-sheet">
      <div class="description">
        {
          sponsor.data.description && (
            <div class="content">
              <p>
                {sponsor.data.description?.replaceAll('"', "")?.trim() ?? ""}
              </p>
            </div>
          )
        }

        {
          video && (
            <>
              <link rel="stylesheet" href="/youtube/youtube.css" />
              <script is:inline src="/youtube/youtube.js" />
              <lite-youtube
                videoid={video}
                style=`background-image: url('https://i.ytimg.com/vi/${video}/hqdefault.jpg');`
              />
            </>
          )
        }
      </div>

      <!--div class="the-talks">
        <h3>Les talks de nos colaborateurs</h3>

        <ul>
          <li>
            <strong><a href="#">Le nom du talk tres tres long qui passe Ã  la logne</a></strong>
            Le nom du speaker
          </li>
          <li>
            <strong><a href="#">Le nom du talk</a></strong>
            Le nom du speaker
          </li>
        </ul>
      </div-->

      <div class="online">
        <h3>Suivre {sponsor.data.name}</h3>
        <ul>
          {
            sponsor.data.twitterAccount && (
              <li>
                <strong class="stressed">Sur X: </strong>
                <a target="_blank" href={sponsor.data.twitterAccount}>
                  {sponsor.data.twitterAccount
                    ?.replace("https://twitter.com/", "")
                    ?.replace("https://x.com/", "")}
                </a>
              </li>
            )
          }
          {
            sponsor.data.linkedinAccount && (
              <li>
                <strong class="stressed">Sur LinkedIn: </strong>
                <a target="_blank" href={sponsor.data.linkedinAccount}>
                  {decodeURI(sponsor.data.linkedinAccount)
                    ?.replace("https://www.linkedin.com/in/", "")
                    ?.replace("https://www.linkedin.com/company/", "")
                    .replace("/", "")}
                </a>
              </li>
            )
          }
          {
            sponsor.data.instagramAccount && (
              <li>
                <strong class="stressed">Sur Instagram: </strong>
                <a target="_blank" href={sponsor.data.instagramAccount}>
                  {sponsor.data.instagramAccount
                    ?.replace("https://www.instagram.com/", "")
                    ?.replace("https://instagram.com/", "")}
                </a>
              </li>
            )
          }
          {
            sponsor.data.facebookAccount && (
              <li>
                <strong class="stressed">Sur Facebook: </strong>
                <a target="_blank" href={sponsor.data.facebookAccount}>
                  {sponsor.data.facebookAccount
                    ?.replace("https://www.facebook.com/", "")
                    ?.replace("https://facebook.com/", "")}
                </a>
              </li>
            )
          }
          {
            sponsor.data.siteUrl && (
              <li>
                <strong class="stressed">Site Web: </strong>
                <a target="_blank" href={sponsor.data.siteUrl}>
                  {sponsor.data.siteUrl}
                </a>
              </li>
            )
          }
        </ul>
      </div>

        {
          (sponsor.data.jobs ?? []).length > 0 && (
            <div class="talk">
              <h3>Mes Offres</h3>
              <p>
                <ul>
                  {sponsor.data.jobs
                    ?.map((job) => (
                      <li>
                        <a href={job.url}>{job.title}</a>
                      </li>
                    ))
                    .join("")}
                </ul>
              </p>
            </div>
          )
        }
    </div>
  </div>
</Layout>
